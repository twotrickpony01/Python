import subprocess
import shlex
def nmap_scanner(targets, output_file, override_flags = None):

    if override_flags:
        nmap_flags = shlex.split(f"nmap {override_flags}")
        subprocess.run(nmap_flags)

    if isinstance(targets, list):
        cmd = shlex.split(f'nmap -sTV -p- -oX {output_file} -iL {targets} --stats-every 20s')
        nmap_process = subprocess.run(cmd, capture_output=True, shell=False,check=True)
        return nmap_process.check_returncode()
    else:
        cmd = shlex.split(f'nmap -sTV -p- -oX {output_file} {targets} --stats-every 20s')
        nmap_process = subprocess.run(cmd, capture_output=True, shell=False,check=True)
        return nmap_process.check_returncode()